! =======
! READ ME
! =======
!
! SVIs remain "shutdown"
! If multiple Wired/ Wireless User VLANs are required, these will need to be manually added
! The Firewall POP (VLAN100) auto assigns the following:
!  - 1st IP address - SVI on the core switch
!  - 2nd IP address - FW Interface (The default route points to this address)
! Only infrastructure interfaces, and User Ports are defined by this generator, wireless, server ports etc. must be defined manually.
!
! ====
! IPAM
! ====
!
! The following IPs have been pre-assigned in this configuration.  
! The pipe "|" separated information below can be used to import into excel, and assigned A and reverse DNS records to ipam.pearson.com as required
!
!
{{loop0_ip}} | {{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{infrastructure_summary | host_address:1}} | ge1-0-1.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{infrastructure_summary | host_address:3}} | ge2-0-1.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{infrastructure_summary | host_address:5}} | ge1-0-2.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{infrastructure_summary | host_address:7}} | ge2-0-2.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{fw_pop_subnet | host_address:1}} | vl{{fw_pop_id}}.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{wireless_pop_subnet | host_address:1}} | vl{{wireless_pop_id}}.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{net_mgmt_subnet | host_address:1}} | vl{{net_mgmt_id}}.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{server_subnet | host_address:1}} | vl{{server_id}}.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{wired_user_1_subnet | host_address:1}} | vl{{wired_user_1_id}}.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{voice_1_subnet | host_address:1}} | vl{{voice_1_id}}.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{video_subnet | host_address:1}} | vl{{video_id}}.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{trusted_wireless_1_subnet | host_address:1}} | vl{{trusted_wireless_1_id}}.{{country | downcase}}-{{site_code | downcase}}-swc01.ptns.pearson.com
{{fw_pop_subnet | host_address:2}} | vl{{fw_pop_id}}.{{country | downcase}}-{{site_code | downcase}}-fwb01.ptns.pearson.com | NOTE: THIS IS THE FIREWALL IP
!
!
! ======
! CONFIG
! ======
!
! //START BASE SECTION
!
!
service timestamps debug datetime msec localtime show-timezone
service timestamps log datetime msec localtime show-timezone
service password-encryption
no service pad
service tcp-keepalives-in
service tcp-keepalives-out
no ip bootp server
no ip http server
no ip http secure-server
no ip source-route
no ip gratuitous-arps
logging buffered 65536 notification
logging trap notification
enable secret {{enable_secret}}
hostname {{country | downcase}}-{{site_code | downcase}}-swc01
username netadmin privilege 15 secret {{user_secret}}
no ip domain-lookup
ip domain-name ptns.pearson.com
clock timezone UTC 0
!
crypto key generate rsa general-keys modulus 2048
!
!
ip ssh version 2       
!
!       
! //END BASE SECTION
!
! //START LOGGING SECTION
! //STN-08007
!
{% template_include logging %}     
!
!
! //END LOGGING SECTION
!
!
! //START QOS SECTION
!
!
mls qos map cos-dscp 0 8 16 24 34 46 48 56
mls qos srr-queue output cos-map queue 1 threshold 3 4 5
mls qos srr-queue output cos-map queue 2 threshold 1 2
mls qos srr-queue output cos-map queue 2 threshold 2 3
mls qos srr-queue output cos-map queue 2 threshold 3 6 7
mls qos srr-queue output cos-map queue 3 threshold 3 0
mls qos srr-queue output cos-map queue 4 threshold 3 1
mls qos srr-queue output dscp-map queue 1 threshold 3 32 34 40 46
mls qos srr-queue output dscp-map queue 2 threshold 1 16 18 20 22 26 28 30 36
mls qos srr-queue output dscp-map queue 2 threshold 1 38
mls qos srr-queue output dscp-map queue 2 threshold 2 24
mls qos srr-queue output dscp-map queue 2 threshold 3 48 56
mls qos srr-queue output dscp-map queue 3 threshold 3 0
mls qos srr-queue output dscp-map queue 4 threshold 1 8
mls qos srr-queue output dscp-map queue 4 threshold 3 10 12 14
mls qos queue-set output 1 threshold 2 80 90 100 100
mls qos queue-set output 1 threshold 4 60 100 100 100
mls qos
!
policy-map TRUST_VVLAN_ONLY
class class-default
trust dscp
!
!
! //END QOS SECTION
!
!
! //START VTP SECTION
!
!
vtp domain {{site_code}}
vtp mode transparent
!
!
! //END VTP SECTION
!
!
! //START SPANNING-TREE SECTION
!
!
spanning-tree mode rapid-pvst
spanning-tree portfast bpduguard default
spanning-tree vlan 1-4094 priority 0
!
!
! //END SPANNING-TREE SECTION
!
!
! //START VLAN SECTION
!
!
vlan {{fw_pop_id}}
 name {{fw_pop_subnet | cidr}}_FW_POP
vlan {{wireless_pop_id}}
 name {{wireless_pop_subnet | cidr}}_WIRELESS_POP
vlan {{net_mgmt_id}}
 name {{net_mgmt_subnet | cidr}}_NETWORK_MGMT
vlan {{server_id}}
 name {{server_subnet | cidr}}_SERVERS
vlan {{wired_user_1_id}}
 name {{wired_user_1_subnet | cidr}}_WIRED_USERS
vlan {{voice_1_id}}
 name {{voice_1_subnet | cidr}}_VOICE
vlan {{video_id}}
 name {{video_subnet | cidr}}_VIDEO
vlan {{trusted_wireless_1_id}}
 name {{trusted_wireless_1_subnet | cidr}}_WIRELESS_USERS
vlan {{guest_wireless_id}}
 name {{guest_wireless_subnet | cidr}}_GUEST_WIRELESS
vlan {{inet_id}}
 name {{inet_subnet | cidr}}_INET_POP
vlan {{native_id}}
 name NATIVE
!
!
! //END VLAN SECTION
!
!
! //START INTERFACE SECTION
!
!
interface Loopback0
 description MGMT
 ip address {{loop0_ip}} 255.255.255.255 
!
interface GigabitEthernet1/0/1
 description [F] {{country | downcase}}-{{site_code | downcase}}-idr01 0/1
 no switchport
 ip address {{infrastructure_summary | host_address:1}} 255.255.255.254
 srr-queue bandwidth share 1 15 70 5
 priority-queue out 
 mls qos trust dscp
!
interface GigabitEthernet1/0/2
 description [F] {{country | downcase}}-{{site_code | downcase}}-idr02 0/1
 no switchport
 ip address {{infrastructure_summary | host_address:5}} 255.255.255.254
 srr-queue bandwidth share 1 15 70 5
 priority-queue out 
 mls qos trust dscp
!
interface GigabitEthernet1/0/3
 description [F] {{country | downcase}}-{{site_code | downcase}}-idr01 0/0/0
 switchport access vlan 900
 switchport mode access
 srr-queue bandwidth share 1 15 70 5
 priority-queue out 
 mls qos trust dscp
!
interface GigabitEthernet2/0/1
 description [F] {{country | downcase}}-{{site_code | downcase}}-idr01 0/2
 no switchport
 ip address {{infrastructure_summary | host_address:3}} 255.255.255.254
 srr-queue bandwidth share 1 15 70 5
 priority-queue out 
 mls qos trust dscp
!
interface GigabitEthernet2/0/2
 description [F] {{country | downcase}}-{{site_code | downcase}}-idr02 0/2
 no switchport
 ip address {{infrastructure_summary | host_address:7}} 255.255.255.254
 srr-queue bandwidth share 1 15 70 5
 priority-queue out 
 mls qos trust dscp
!
interface GigabitEthernet2/0/3
 description [F] {{country | downcase}}-{{site_code | downcase}}-idr02 0/0/0
 switchport access vlan 900
 switchport mode access
 srr-queue bandwidth share 1 15 70 5
 priority-queue out 
 mls qos trust dscp
!
interface range GigabitEthernet1/0/4-48
 description USER
 switchport access vlan {{wired_user_1_id}}
 switchport mode access
 switchport voice vlan {{voice_1_id}}
 srr-queue bandwidth share 1 15 70 5
 priority-queue out
 queue-set 1
 mls qos vlan-based
 spanning-tree portfast
!
interface range GigabitEthernet2/0/4-48
 description USER
 switchport access vlan {{wired_user_1_id}}
 switchport mode access
 switchport voice vlan {{voice_1_id}}
 srr-queue bandwidth share 1 15 70 5
 priority-queue out
 queue-set 1
 mls qos vlan-based
 spanning-tree portfast
!
{% if stack == "3" or if stack == "4"  %}
interface range GigabitEthernet3/0/1-48
 description USER
 switchport access vlan {{wired_user_1_id}}
 switchport mode access
 switchport voice vlan {{voice_1_id}}
 srr-queue bandwidth share 1 15 70 5
 priority-queue out
 queue-set 1
 mls qos vlan-based
 spanning-tree portfast
{% endif %}
!
{% if stack == "4"  %}
interface range GigabitEthernet4/0/1-48
 description USER
 switchport access vlan {{wired_user_1_id}}
 switchport mode access
 switchport voice vlan {{voice_1_id}}
 srr-queue bandwidth share 1 15 70 5
 priority-queue out
 queue-set 1
 mls qos vlan-based
 spanning-tree portfast
{% endif %}
!
interface Vlan1
 no ip address
 shutdown
!
interface vlan {{fw_pop_id}}
 description FW_POP
 ip address {{fw_pop_subnet | host_address:1}} {{fw_pop_subnet | mask}}
!
interface vlan {{wireless_pop_id}}
 description WIRELESS_POP
 ip address {{wireless_pop_subnet | host_address:1}} {{wireless_pop_subnet | mask}}
 ip helper-address {{ip_helper_1}}
 ip helper-address {{ip_helper_2}}
!
interface vlan {{net_mgmt_id}}
 description NETWORK_MGMT
 ip address {{net_mgmt_subnet | host_address:1}} {{net_mgmt_subnet | mask}}
!
interface vlan {{server_id}}
 description SERVERS
 ip address {{server_subnet | host_address:1}} {{server_subnet | mask}}
!
interface vlan {{wired_user_1_id}}
 description WIRED_USERS
 ip address {{wired_user_1_subnet | host_address:1}} {{wired_user_1_subnet | mask}}
 ip helper-address {{ip_helper_1}}
 ip helper-address {{ip_helper_2}}
!
interface vlan {{voice_1_id}}
 description VOICE
 ip address {{voice_1_subnet | host_address:1}} {{voice_1_subnet | mask}}
 ip helper-address {{ip_helper_1}}
 ip helper-address {{ip_helper_2}}
!
interface vlan {{video_id}}
 description VIDEO
 ip address {{video_subnet | host_address:1}} {{video_subnet | mask}}
 ip helper-address {{ip_helper_1}}
 ip helper-address {{ip_helper_2}}
!
interface vlan {{trusted_wireless_1_id}}
 description WIRELESS_USERS
 ip address {{trusted_wireless_1_subnet | host_address:1}} {{trusted_wireless_1_subnet | mask}}
 ip helper-address {{ip_helper_1}}
 ip helper-address {{ip_helper_2}}
!
!
! //END INTERFACE SECTION
!
!
! //START ROUTING SECTION
!
!
router eigrp 1
 no auto-summary
 no eigrp log-neighbor-changes 
 network {{loop0_ip}} 0.0.0.0
 network {{infrastructure_summary | host_address:1}} 0.0.0.0
 network {{infrastructure_summary | host_address:3}} 0.0.0.0
 network {{infrastructure_summary | host_address:5}} 0.0.0.0
 network {{infrastructure_summary | host_address:7}} 0.0.0.0
 network {{fw_pop_subnet | host_address:1}} 0.0.0.0
 network {{wireless_pop_subnet | host_address:1}} 0.0.0.0
 network {{net_mgmt_subnet | host_address:1}} 0.0.0.0
 network {{server_subnet | host_address:1}} 0.0.0.0
 network {{wired_user_1_subnet | host_address:1}} 0.0.0.0
 network {{voice_1_subnet | host_address:1}} 0.0.0.0
 network {{video_subnet | host_address:1}} 0.0.0.0
 network {{trusted_wireless_1_subnet | host_address:1}} 0.0.0.0
 passive-interface default
 no passive-interface GigabitEthernet1/0/1
 no passive-interface GigabitEthernet2/0/1
 no passive-interface GigabitEthernet1/0/2
 no passive-interface GigabitEthernet2/0/2
 eigrp stub connected summary
! 
ip route 0.0.0.0 0.0.0.0 {{fw_pop_subnet | host_address:2}}
!
!
! //END ROUTING SECTION
!
!
! //START ACL SECTION
!
!
access-list 98 remark LoginAccess
access-list 98 permit 10.111.0.0 0.0.255.255
!
access-list 99 remark SNMPManager
access-list 99 permit 10.111.0.0 0.0.255.255
!
!
! //END ACL SECTION
!
! //START SNMP SECTION
! 
!   
{% template_include snmp %}
!
!
! //END SNMP SECTION
!
! //NTP SECTION
!
!
{% template_include ntp %}
!
!
! //END NTP SECTION
!
!
! //START ALIAS SECTION
!
{% template_include alias %}
!
! //END ALIAS SECTION
!
!
! //START LOGIN BANNER SECTION
!
{% template_include banner_login %}
!
! //END LOGIN BANNER SECTION
!
!
! //START LINE SECTION
!
!       
line con 0       
  password {{line_pass}}
  login local
  logging synchronous
  exec-timeout 30 0
!       
line aux 0
  password {{line_pass}}
  login
  logging synchronous
  exec-timeout 30 0
!       
line vty 0 15
  password {{line_pass}}
  login local
  logging synchronous
  access-class 98 in
  exec-timeout 30 0
!
!
! //END LINE SECTION
!
! //START TACACS SECTION
!
!    
{% template_include tacacs %}
!
!
! //END TACACS SECTION
!
!
! //START SDM SECTION
! The following command requires a reboot of the platform to take effect
! 
sdm prefer routing
!
!
! //END SDM SECTION
!
!
! // START METADATA
!
!
{% template_include banner_incoming %}
!
!
! // END METADATA